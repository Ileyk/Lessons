\documentclass[handout]{beamer}
%\documentclass{beamer}


% MAKEN VAN BACKGROUND ETC.
\mode<presentation> {
 \usetheme{CambridgeUS} %stijl van de presentatie
  \setbeamercovered{transparent}
    \usecolortheme{beaver} %kleurpatroon
}

% INLADEN VAN PACKAGES%


\usepackage{psboxit}
\usepackage{fancybox}
\usepackage{colordvi}
\usepackage{epsfig}
\usepackage{url}
\usepackage{palatino}
\usepackage[dutch]{babel}
\usepackage[latin1]{inputenc} 
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{subfigure}
\newtheorem{eigenschap}[theorem]{Eigenschap}
\usepackage{amssymb,amsmath}
\usepackage{pgflibraryarrows}
\usepackage{tikz}
\usepackage[absolute,overlay]{textpos}
\usepackage{colortbl}
\usepackage{multimedia}

\usepackage{hyperref}
\hypersetup{
    colorlinks,%
    citecolor=black,%
    filecolor=black,%
    linkcolor=black,%
    urlcolor=blue     % can put red here to visualize the links
}

%\DeclareGraphicsExtensions{.pdf,.png,.gif,.jpg}

\newcommand*{\pso}{$P_{\text{SO}}$\@\xspace}
\newcommand*{\porb}{$P_{\text{orb}}$\@\xspace}
\newcommand*{\pqm}{$P_{\text{?}}$\@\xspace}
\newcommand*{\ppso}{P_{\text{SO}}}
\newcommand*{\pporb}{P_{\text{orb}}}
\newcommand*{\ppqm}{P_{\text{?}}}
\newcommand{\mystar}{{\fontfamily{lmr}\selectfont$\star$}}
\newcommand*{\pstr}{$P_{\text{\mystar}}$\@\xspace}
\newcommand{\sgx}{SgXB\xspace}
\newcommand{\sfxt}{SFXT}
\newcommand{\sg}{Sg\xspace}
\newcommand{\co}{CO\xspace}
\newcommand*{\hmxb}{HMXB\@\xspace}
\newcommand*{\rlof}{RLOF\@\xspace}
\newcommand*{\ns}{NS\@\xspace}
\newcommand*{\eg}{e.g.\@\xspace}
\newcommand*{\ie}{i.e.\@\xspace}
\newcommand*{\aka}{a.k.a. \@\xspace}
\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newcommand*{\msun}{$M_{\odot}$\@\xspace}

\setcounter{tocdepth}{1}

%-------Textpos setup and grid command-----

\setlength{\TPHorizModule}{\the\paperwidth}  %defines unit length for textpos

\newcommand<>{\makegrid}[0]{
\begin{textblock}{1}(0,0) % width of block, origin at top left corner of page
\uncover#1{
\begin{tikzpicture}[color=blue!40!black!30,very thin]
\draw[step=.5cm,draw opacity=.5] (0,0) grid
(\the\paperwidth,\the\paperheight);
\foreach \x in {1,2,...,12}
   \draw[text=black] (\x,.15) node {\footnotesize \x};
\foreach \y in {1,2,...,9}
   \draw[text=black] (.2,\y) node {\footnotesize \y};
\end{tikzpicture}  }
\end{textblock}
}

\newcommand{\btx}{\begin{textblock}{1}(0,0)}
\newcommand{\etx}{\end{textblock}}

% INLADEN VAN MACRO-FILE
 \input{../ldmacros}
 \input{../rkmacros}

% wat er op de titel pagina zal staan
\author[El Mellah \& Sundqvist]{Ileyk El Mellah \& Jon Sundqvist}
\institute[KU Leuven]{ 
\begin{figure}
\includegraphics[width=2cm]{figures/sedes.jpg}
\end{figure}
\scriptsize 
Centre for mathematical Plasma Astrophysics \\
Instituut voor Sterrenkunde\\ 
KU Leuven
}
\date[2018-2019]

% voor de korte inhoud
\AtBeginSection[] %zorgt voor de korte inhoud (afhankelijk van het gekozen thema)
 {
   \begin{frame}%<beamer>
    \title{CONTENTS}
    \tableofcontents[currentsection] %kan eventueel nog aangepast worden met currentsubsection enz, licht deze sectie op in korte inhoud
  \end{frame}
 }

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{saveenumi}
\newcounter{saveenumiplus}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TITLEPAGE
\title[G0B30A Computational Methods]{Computational Methods \\for Astrophysical Applications}
\frame{\titlepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{References}
\BD

\bul \BF{Books} \hfill \\
- \href{http://www.beck-shop.de/fachbuch/leseprobe/9783540252023_Excerpt_001.pdf}{\textit{Riemann solvers and numerical methods for fluid dynamics - A practical introduction}}, by Toro\\
- \href{https://pdfs.semanticscholar.org/1470/c6f43c769572c4cfc94ffc9c5710484ff1e5.pdf}{\textit{Numerical methods for conservation laws}}, by Leveque\\
- \href{http://www.tevza.org/home/course/modelling-II_2016/books/Leveque\%20-\%20Finite\%20Volume\%20Methods\%20for\%20Hyperbolic\%20Equations.pdf}{\textit{Finite volume methods for hyperbolic problems}}, by Leveque

\bul \BF{Courses} \hfill \\
- Rony Keppens \& Jon Sundqvist 2016-2017\\
- \href{https://www3.nd.edu/~dbalsara/Numerical-PDE-Course/}{\textit{Numerical PDE Techniques for Scientists and Engineers}}, by Dinshaw Balsara

\bul \BF{Schools} \hfill \\
- \href{https://www.houches-school-physics.com/program/}{Les Houches}\\
- \href{http://mhdsim.uni-koeln.de/\#pre}{Numerical techniques in MHD simulations}, K\"{o}ln University

\ED
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\begin{center}
  \framebox[.8\textwidth]{\color{darkred}{\textbf{Lesson 1 : Hyperbolic Partial Differential Equations}}}
\end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\BD

\svsp
\bul \BF{Conservation laws} \hfill \\
Integral and differential forms\\
Examples

\bul \BF{Hyperbolic PDE} \hfill \\
Matrix formulation of conservation laws\\
Time advance\\
Linear advective equations\\
The Riemann problem

\ED
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conservation laws}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Integral and differential forms}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Integral form}

\BD

\bul Continuous medium hypothesis : from actual particles to particles of fluid
\iar distribution function and integration of Boltzmann equation : the closure problem
\iar analogy with moments of the specific photon intensity (see Prof. Sundqvist's course)

\bul Consider \BF{any volume element} $\diff V$ of a fluid
\iar XXX bilan XXX over $\diff t$ of scalar quantity : inflow/outflow, sinks/sources
\iar for the momentum : tensor formulation and dyadic product
\iar for energy

\bul Shocks and jump conditions : Rankine-Hugoniot

\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Conservation form}

\BD

\bul Provided the variables $X\left( \mathbf{r}, t \right)$ are XXX differentiable XXX
$$ \partial_t X + \nabla \cdot \underbrace{ \left[ F\left( X, \mathbf{v}, t \right) \right]}_{\text{fluxes}} = \underbrace{S\left( \mathbf{r}, \mathbf{v}, t \right)}_{sources/sinks} $$

\bul Properties of this differential form
\iar Coordinate / dimension independent formulation % beware the nabla operator though!
\iar Given inital and boundary conditions, can provide a general solution
\iar Conservation form : Green-Ostrogradsky (or Gauss) law and Eulerian approach
\iar Conservative variables : $\rho$, $\rho\mathbf{v}$ and $e$

\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Primitive form}

\BD

\bul Lagrangian approach
XXX Picture of a parachute XXX
$$ D_t \left( \cdot \right) = \partial_t \left( \cdot \right) + \mathbf{v} \nabla \left( \cdot \right) $$
% beware the \mathbf{v} \nabla operator

\bul Continuity equation
$$ D_t \left( \rho \right) = - \rho \nabla \mathbf{v} $$
\iar incompressible fluid $\neq$ flow

\bul Navier-Stokes equation
$$ \rho D_t \left( \mathbf{v} \right) = - \nabla P $$

\bul Energy equation
\iar internal and mechanical energy % the system has internal structure (/= point mechanics)
\iar link w/ 1$^{st}$ principle of Thermodynamics
\iar entropy formulation

\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Closure relation}

\BD
\bul Equation-of-state of an ideal gas
$$u=\frac{P}{\gamma -1}$$
\iar adiabatic index $\gamma$

\bul A classic way-around : the polytropic assumption
$$P\propto\rho^{\alpha}$$
\iar polytropic index $\alpha$
\iar the isentropic case

\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Examples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{The linear advection equation}

\BD
\bul Consider the 1D continuity equation w/ constant \& uniform speed $v$
$$\partial_t \rho+ v \partial_x \rho =0$$
\iar initial conditions $\rho(x,t=0)=\rho_0(x)$

\bul Analytic solution
$$\rho(x,t)=\rho_0(x-vt)$$
\bul Fourier analysis
$$\rho \left(x,t\right) = r\left(k,t\right) e^{ikx}$$
XXX
\iar non-dissipative
\iar non-dispersive
\iar see also DB1#32-33

\bul Numerical solution

\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Euler equations}

\BD
\bul Consider the viscous tensor $\XXX{\tau}$
$$\XXX{\tau}=\mu\left[\left(\nablaXXX \mathbf{v} +\nablaXXX \mathbf{v}^t \right) - \frac{2}{3} \left(\nabla\cdot\mathbf{v}\mathbb{1}\right)\right]$$
\iar see Landau Lifschitz section XXX for hypothesis \& shape
\iar $\mu$ dynamic viscosity in XXX
\iar conservative formulation
\iar Dimensionless form, Reynolds number and singular limit (Lagrange paradox? XXX)
\ED

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Ideal Magneto-Hydrodynamics equations}

\BD
\bul Ideal MHD fundamental hypothesis
$$ \mathbf{E}+\mathbf{j}\wedge\mathbf{B}=\mathbf{0} $$
\iar $\mathbf{E}$ secondary variable 

\bul Maxwell-Faraday and Maxwell-Amp\`{e}re give the induction equation XXX :
$$\mathbf{\nabla}\wedge\mathbf{B}-\partial_t\left((\mathbf{\nabla}\wedge\mathbf{B})\wedge\mathbf{B}\right)=\mathbf{0}$$
\iar magnetic pressure and XXX Prandtl XXX number
\iar magnetic tension

\bul Frozen-flux theorem

\ED
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hyperbolic PDE}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linear system of PDE}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Jacobian}

\bul Consider the linear advection equation :
$$\partial_t \rho+ v \partial_x \rho =0$$


\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linearization of non-linear PDE}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Matrix formulation of conservation laws}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Flux Jacobian}

\bul In matrix form, the 1D conservation laws without source terms are written :
$$ \partial_t U + \partial_x \left[ XXX \mathbf{F}\left( U \right) \right]=0$$
where 
$$\mathbf{U}=\left(\rho,\rho v,e \right)$$
and the vector of fluxes is :
\begin{equation}
\begin{aligned}
  \mathbf{F} \colon \mathbb{R}^3 &\to \mathbb{M}_{3,1}\\
  \mathbf{U} \mapsto &\mathbb{F}(\mathbf{U})=\left(
\begin{array}{c}
\rho\mathbf{v}\\
\rho\mathbf{v}\mathop{\otimes}\mathbf{v}+P\mathbb{1}\\
\left(e+P\right)\mathbf{v}\\
\end{array}
\right)
\end{aligned}
\end{equation}


\bul Chain rule
$$ \partial_t \mathbf{U} + \mathbf{AXXX} \left( \mathbf{U} \right) \partial_x  \mathbf{U} =0$$
with $\mathbf{AXXX} \left( \mathbf{U} \right)$ the Jacobian matrix :
$$ \mathbf{AXXX} = \partial \mathbf{F} / \partial \mathbf{U} $$
\iar similar to linear advection % quasi-linear form

% And in 3D? Is F still a vector?

% Write the linear advection and Burgers equation in quasi-linear form. What are their Jacobians?

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Eigenvalues \& eigenvectors}


\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Hyperbolic, parabolic and elliptic PDE}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Linear, non-linear \& quasi-linear}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Time advance}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Explicit}


\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Implicit}


\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linear advective equations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Properties}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Characteristics}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Stencils, domain of dependence, range of influence}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The Riemann problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{The Riemann problem}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
